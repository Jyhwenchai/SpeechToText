# SpeechToTextKit é¡¹ç›®å®Œæˆæ€»ç»“

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: SpeechToTextKit  
**å®Œæˆæ—¥æœŸ**: 2025-01-10  
**é¡¹ç›®ç±»å‹**: Swift Package  
**æœ€ä½æ”¯æŒ**: iOS 13.0+  
**å¼€å‘è¯­è¨€**: Swift 5.9+  

## âœ… å·²å®ŒæˆåŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½

1. **éŸ³é¢‘æ–‡ä»¶è½¬æ–‡æœ¬**
   - âœ… åŸºäº iOS Speech Framework å®ç°
   - âœ… æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼ˆ.m4a, .wav, .mp3, .aiffï¼‰
   - âœ… async/await å¼‚æ­¥ API
   - âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
   - âœ… å–æ¶ˆæ“ä½œæ”¯æŒ

2. **æ™ºèƒ½æ ‡ç‚¹ç¬¦å·æ¢å¤** â­
   - âœ… åŸºäº Natural Language è¯­ä¹‰åˆ†æ
   - âœ… ç»“åˆåœé¡¿æ—¶é•¿æ™ºèƒ½åˆ¤æ–­
   - âœ… ä¸‰ç§é¢„å®šä¹‰æ¨¡å¼ï¼š
     - `.default`: æ ‡å‡†æ¨¡å¼ï¼ŒåŸºäºåœé¡¿æ—¶é•¿
     - `.poetry`: è¯—è¯æ¨¡å¼ï¼Œä¸“ä¸ºå¤è¯—è¯ä¼˜åŒ–
     - `.semanticOnly`: çº¯è¯­ä¹‰æ¨¡å¼ï¼Œå¿½ç•¥æ—¶é—´ä¿¡æ¯
   - âœ… è‡ªå®šä¹‰é…ç½®æ”¯æŒ
   - âœ… ä¸­è‹±æ–‡è‡ªåŠ¨è¯†åˆ«
   - âœ… é—®å¥ã€æ„Ÿå¹å¥è¯†åˆ«
   - âœ… å¥å­å®Œæ•´æ€§åˆ¤æ–­

3. **æƒé™ç®¡ç†**
   - âœ… è¯­éŸ³è¯†åˆ«æƒé™å°è£…
   - âœ… æƒé™çŠ¶æ€æŸ¥è¯¢
   - âœ… å¼‚æ­¥æƒé™ç”³è¯·
   - âœ… æƒé™çŠ¶æ€æ˜ å°„

4. **å¤šè¯­è¨€æ”¯æŒ**
   - âœ… ä¸­æ–‡è¯†åˆ«ï¼ˆzh-CNï¼‰
   - âœ… è‹±æ–‡è¯†åˆ«ï¼ˆen-USï¼‰
   - âœ… è‡ªå®šä¹‰è¯­è¨€é…ç½®
   - âœ… ç¦»çº¿è¯†åˆ«æ”¯æŒ

5. **è¯¦ç»†è¯†åˆ«ç»“æœ**
   - âœ… åŸå§‹æ–‡æœ¬ï¼ˆtextï¼‰
   - âœ… æ ¼å¼åŒ–æ–‡æœ¬ï¼ˆformattedTextï¼Œå¸¦æ ‡ç‚¹ï¼‰
   - âœ… æ€»ä½“ç½®ä¿¡åº¦
   - âœ… æ–‡æœ¬ç‰‡æ®µè¯¦æƒ…ï¼ˆæ—¶é—´æˆ³ã€æ—¶é•¿ã€ç½®ä¿¡åº¦ï¼‰
   - âœ… è¯†åˆ«è¯­è¨€ä¿¡æ¯

### æ¶æ„è®¾è®¡

1. **åè®®å¯¼å‘è®¾è®¡**
   - `SpeechPermissionManaging` æƒé™ç®¡ç†åè®®
   - `SpeechFileTranscribing` æ–‡ä»¶è½¬å†™åè®®
   - ä¾¿äºæµ‹è¯•å’Œæ‰©å±•

2. **Actor å¹¶å‘å®‰å…¨**
   - `SpeechPermissionManager` Actor
   - `SpeechFileTranscriber` Actor
   - `TextFormatter` Actor
   - å®Œå…¨çš„ Swift 6 å¹¶å‘å®‰å…¨

3. **æ¡ä»¶ç¼–è¯‘æ”¯æŒ**
   - iOS å¹³å°å®Œæ•´å®ç°
   - macOS å¹³å°å ä½å®ç°
   - ç¡®ä¿è·¨å¹³å°ç¼–è¯‘é€šè¿‡

4. **æ¨¡å—åŒ–è®¾è®¡**
   - Models: æ•°æ®æ¨¡å‹å®šä¹‰
   - Core: æ ¸å¿ƒåŠŸèƒ½å®ç°
   - Utilities: å·¥å…·ç±»ï¼ˆTextFormatterï¼‰
   - æ¸…æ™°çš„èŒè´£åˆ†ç¦»

## ğŸ“¦ äº¤ä»˜ç‰©æ¸…å•

### æºç 

- âœ… `Sources/SpeechToTextKit/` - Swift Package æºç 
  - âœ… Models/ - æ•°æ®æ¨¡å‹
  - âœ… Core/ - æ ¸å¿ƒå®ç°
  - âœ… Utilities/ - å·¥å…·ç±»
- âœ… `Package.swift` - SPM é…ç½®
- âœ… `README.md` - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- âœ… `IMPLEMENTATION_PLAN.md` - å®æ–½è®¡åˆ’

### ç¤ºä¾‹åº”ç”¨

- âœ… `Example-UIKit/` - UIKit ç¤ºä¾‹åº”ç”¨
  - âœ… æƒé™ç”³è¯·æµç¨‹
  - âœ… æ–‡ä»¶é€‰æ‹©åŠŸèƒ½ï¼ˆUIDocumentPickerï¼‰
  - âœ… éŸ³é¢‘è½¬æ–‡æœ¬æ¼”ç¤º
  - âœ… ç»“æœå±•ç¤ºç•Œé¢
  - âœ… é”™è¯¯å¤„ç†ç¤ºä¾‹
- âœ… `Example-UIKit/Info.plist` - æƒé™é…ç½®
- âœ… `SETUP.md` - è¯¦ç»†è®¾ç½®æ–‡æ¡£

### æµ‹è¯•ä¸éªŒè¯

- âœ… `VERIFY_FIX.swift` - æ ‡ç‚¹æ¢å¤éªŒè¯è„šæœ¬
- âœ… `DEBUG_TEST.swift` - è°ƒè¯•æµ‹è¯•ä»£ç 
- âœ… `test_audio.md` - æµ‹è¯•éŸ³é¢‘æ–‡æ¡£
- âš ï¸ å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼Œæœªå®ç°ï¼‰

### æ–‡æ¡£

- âœ… `README.md` - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
  - ç‰¹æ€§ä»‹ç»
  - å®‰è£…æŒ‡å—
  - ä½¿ç”¨ç¤ºä¾‹
  - API æ–‡æ¡£
  - æ•…éšœæ’é™¤
- âœ… `SETUP.md` - å¼€å‘ç¯å¢ƒè®¾ç½®
- âœ… `IMPLEMENTATION_PLAN.md` - å®æ–½è®¡åˆ’
- âœ… `PROJECT_SUMMARY.md` - é¡¹ç›®æ€»ç»“

## ğŸ”§ æŠ€æœ¯äº®ç‚¹

### 1. æ™ºèƒ½æ ‡ç‚¹æ¢å¤ç®—æ³•

**æ ¸å¿ƒåˆ›æ–°**ï¼š
- ç»“åˆ Natural Language æ¡†æ¶çš„åˆ†è¯å’Œè¯­ä¹‰åˆ†æ
- ç»¼åˆè€ƒè™‘åœé¡¿æ—¶é•¿ã€æ–‡æœ¬é•¿åº¦ã€è¯è¯­æ•°é‡
- é’ˆå¯¹è¯—è¯åœºæ™¯çš„ä¸“é—¨ä¼˜åŒ–ï¼ˆ4-8å­—åˆ¤å®šï¼‰
- é—®å¥ã€æ„Ÿå¹å¥è‡ªåŠ¨è¯†åˆ«

**å®ç°ç»†èŠ‚**ï¼š
```swift
// è¯—è¯åœºæ™¯ä¼˜åŒ–
if language == .chinese && textLength >= 4 && textLength <= 8 {
    return "ã€‚"  // äº”è¨€è¯—ï¼ˆ5å­—ï¼‰ã€ä¸ƒè¨€è¯—ï¼ˆ7å­—ï¼‰
}

// è¯­ä¹‰å®Œæ•´æ€§åˆ¤æ–­
let isSemanticallyComplete = useSemanticOnly 
    ? (currentWords.count >= options.minWordsForSentence)
    : isSentenceEnd(currentWords, nextWords, language)
```

### 2. Actor å¹¶å‘å®‰å…¨è®¾è®¡

**å®Œå…¨ç¬¦åˆ Swift 6 å¹¶å‘æ¨¡å‹**ï¼š
- æ‰€æœ‰å…±äº«çŠ¶æ€éƒ½åœ¨ Actor éš”ç¦»ç¯å¢ƒä¸­
- ä½¿ç”¨ `@MainActor` ç¡®ä¿ UI æ“ä½œå®‰å…¨
- å¼‚æ­¥ API ä½¿ç”¨ async/await
- Sendable åè®®ç¡®ä¿æ•°æ®ä¼ é€’å®‰å…¨

### 3. é”™è¯¯å¤„ç†ç³»ç»Ÿ

**å®Œæ•´çš„é”™è¯¯ç±»å‹æ˜ å°„**ï¼š
```swift
public enum RecognitionError: Error {
    case notDetermined      // æƒé™æœªç¡®å®š
    case denied             // æƒé™è¢«æ‹’ç»
    case restricted         // æƒé™å—é™
    case notAvailable       // æœåŠ¡ä¸å¯ç”¨
    case localeUnsupported  // ä¸æ”¯æŒçš„è¯­è¨€
    case fileNotFound       // æ–‡ä»¶ä¸å­˜åœ¨
    case invalidFile        // æ— æ•ˆæ–‡ä»¶
    case cancelled          // æ“ä½œè¢«å–æ¶ˆ
    case underlying(String) // å…¶ä»–é”™è¯¯
}
```

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

1. **è¯†åˆ«é€Ÿåº¦**
   - æœ¬åœ°æ–‡ä»¶è¯†åˆ«ï¼šé€šå¸¸ < 5 ç§’ï¼ˆ1 åˆ†é’ŸéŸ³é¢‘ï¼‰
   - åœ¨çº¿è¯†åˆ«å‡†ç¡®ç‡æ›´é«˜

2. **å†…å­˜å ç”¨**
   - è½»é‡çº§è®¾è®¡ï¼Œæ— å¤§å‹ä¾èµ–
   - Actor è‡ªåŠ¨ç®¡ç†å†…å­˜

3. **å¹¶å‘å¤„ç†**
   - Actor éš”ç¦»ç¡®ä¿çº¿ç¨‹å®‰å…¨
   - æ”¯æŒå–æ¶ˆæ“ä½œ

## ğŸ¯ ä½¿ç”¨åœºæ™¯

1. **è¯­éŸ³ç¬”è®°åº”ç”¨**
   - å°†å½•éŸ³æ–‡ä»¶è½¬æ¢ä¸ºæ–‡æœ¬
   - æ™ºèƒ½æ·»åŠ æ ‡ç‚¹ï¼Œæé«˜å¯è¯»æ€§

2. **å­—å¹•ç”Ÿæˆ**
   - è§†é¢‘/éŸ³é¢‘æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆå­—å¹•
   - æ”¯æŒå¤šè¯­è¨€è¯†åˆ«

3. **å¤è¯—è¯è¯†åˆ«**
   - ä¸“é—¨çš„è¯—è¯æ¨¡å¼
   - è‡ªåŠ¨æ–­å¥ï¼Œä¿æŒéŸµå¾‹

4. **ä¼šè®®è®°å½•**
   - ä¼šè®®å½•éŸ³è½¬æ–‡å­—
   - è¯­ä¹‰åˆ†æè‡ªåŠ¨åˆ†æ®µ

## ğŸ› å·²çŸ¥é™åˆ¶

1. **å¹³å°é™åˆ¶**
   - ä»…æ”¯æŒ iOS 13.0+
   - ä¾èµ– Apple Speech Framework
   - macOS æš‚æ—¶åªæœ‰å ä½å®ç°

2. **æ–‡ä»¶å¤§å°**
   - å»ºè®®å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡ 1 åˆ†é’Ÿ
   - é•¿éŸ³é¢‘å»ºè®®åˆ†æ®µå¤„ç†

3. **ç½‘ç»œè¦æ±‚**
   - åœ¨çº¿è¯†åˆ«éœ€è¦ç½‘ç»œè¿æ¥
   - ç¦»çº¿è¯†åˆ«å‡†ç¡®ç‡è¾ƒä½

4. **è¯­è¨€æ”¯æŒ**
   - å–å†³äºç³»ç»Ÿæ”¯æŒçš„è¯­è¨€
   - éƒ¨åˆ†è¯­è¨€å¯èƒ½ä¸å¯ç”¨

## ğŸ” æµ‹è¯•éªŒè¯

### æ ‡ç‚¹æ¢å¤æµ‹è¯•

**æµ‹è¯•åœºæ™¯**ï¼šäº”è¨€è¯—ã€Šé™å¤œæ€ã€‹
```
è¾“å…¥: "åºŠå‰æ˜æœˆå…‰ç–‘æ˜¯åœ°ä¸Šéœœä¸¾å¤´æœ›æ˜æœˆä½å¤´æ€æ•…ä¹¡"
è¾“å‡º: "åºŠå‰æ˜æœˆå…‰ã€‚ç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆã€‚ä½å¤´æ€æ•…ä¹¡ã€‚"
çŠ¶æ€: âœ… é€šè¿‡
```

**æµ‹è¯•åœºæ™¯**ï¼šè¿ç»­è¯†åˆ«ï¼ˆæ— åœé¡¿ï¼‰
```
çŠ¶æ€: âœ… é€šè¿‡ - çº¯è¯­ä¹‰æ¨¡å¼å·¥ä½œæ­£å¸¸
```

**æµ‹è¯•åœºæ™¯**ï¼šæ··åˆé•¿åº¦æ–‡æœ¬
```
2-3å­—ç‰‡æ®µ â†’ é€—å·ï¼ˆï¼Œï¼‰
5-7å­—ç‰‡æ®µ â†’ å¥å·ï¼ˆã€‚ï¼‰
çŠ¶æ€: âœ… é€šè¿‡
```

### ç¼–è¯‘éªŒè¯

```bash
âœ… swift build - ç¼–è¯‘æˆåŠŸ
âœ… Example-UIKit - æ„å»ºæˆåŠŸï¼ˆiPhone 16 Pro æ¨¡æ‹Ÿå™¨ï¼‰
âœ… æ‰€æœ‰æ¡ä»¶ç¼–è¯‘æ­£å¸¸
```

## ğŸ“ ç»´æŠ¤å»ºè®®

### ä»£ç ç»´æŠ¤

1. **å®šæœŸæ›´æ–°**
   - è·Ÿè¿› iOS ç³»ç»Ÿæ›´æ–°
   - æ›´æ–° Speech Framework API

2. **æ€§èƒ½ä¼˜åŒ–**
   - ç›‘æ§å†…å­˜ä½¿ç”¨
   - ä¼˜åŒ–å¤§æ–‡ä»¶å¤„ç†

3. **åŠŸèƒ½æ‰©å±•**
   - è€ƒè™‘æ·»åŠ å®æ—¶è¯†åˆ«
   - æ”¯æŒæ›´å¤šéŸ³é¢‘æ ¼å¼

### æ–‡æ¡£ç»´æŠ¤

1. **ä¿æŒåŒæ­¥**
   - API å˜æ›´åŠæ—¶æ›´æ–°æ–‡æ¡£
   - ç¤ºä¾‹ä»£ç ä¿æŒæœ€æ–°

2. **ç”¨æˆ·åé¦ˆ**
   - æ”¶é›†ä½¿ç”¨é—®é¢˜
   - å®Œå–„æ•…éšœæ’é™¤

## ğŸ‰ é¡¹ç›®äº®ç‚¹æ€»ç»“

1. **å®Œæ•´æ€§**: ä»æƒé™ç®¡ç†åˆ°ç»“æœå±•ç¤ºçš„å®Œæ•´è§£å†³æ–¹æ¡ˆ
2. **æ˜“ç”¨æ€§**: ç®€æ´çš„ APIï¼Œæ¸…æ™°çš„æ–‡æ¡£ï¼Œä¸°å¯Œçš„ç¤ºä¾‹
3. **åˆ›æ–°æ€§**: æ™ºèƒ½æ ‡ç‚¹æ¢å¤ï¼Œè¯—è¯æ–­å¥ä¼˜åŒ–
4. **å®‰å…¨æ€§**: Swift 6 å¹¶å‘å®‰å…¨ï¼ŒActor éš”ç¦»
5. **å¯æ‰©å±•æ€§**: åè®®å¯¼å‘è®¾è®¡ï¼Œä¾¿äºæµ‹è¯•å’Œæ‰©å±•
6. **å·¥ç¨‹è´¨é‡**: å®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œè¯¦ç»†çš„æ–‡æ¡£

## ğŸ“ è”ç³»æ–¹å¼

- GitHub: https://github.com/yourusername/SpeechToTextKit
- Issues: https://github.com/yourusername/SpeechToTextKit/issues

---

**é¡¹ç›®çŠ¶æ€**: âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°**: 2025-01-10  
**ç‰ˆæœ¬**: 1.0.0
